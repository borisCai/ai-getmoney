<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>快乐英语乐园 - 二年级英语学习</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script>
    // 配置Tailwind自定义颜色和字体
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#4F46E5', // 主色调：紫色（友好且有趣）
            secondary: '#EC4899', // 辅助色：粉色（活泼）
            accent: '#F59E0B', // 强调色：橙色（吸引注意力）
            success: '#10B981', // 成功色：绿色
            neutral: '#F3F4F6', // 中性色：浅灰
          },
          fontFamily: {
            fun: ['"Comic Sans MS"', '"Marker Felt"', 'Arial', 'sans-serif'],
          },
        },
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .bounce-slow {
        animation: bounce 2s infinite;
      }
      .float {
        animation: float 3s ease-in-out infinite;
      }
      .card-flip {
        perspective: 1000px;
        transform-style: preserve-3d;
      }
      .card-inner {
        transition: transform 0.6s;
        transform-style: preserve-3d;
      }
      .card-flipped .card-inner {
        transform: rotateY(180deg);
      }
      .card-front, .card-back {
        backface-visibility: hidden;
      }
      .card-back {
        transform: rotateY(180deg);
      }
    }

    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
  </style>
</head>
<body class="font-fun bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
  <!-- 顶部导航栏 -->
  <header class="bg-white/80 backdrop-blur-md shadow-sm fixed top-0 left-0 right-0 z-50 transition-all duration-300">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <i class="fa fa-star text-accent text-2xl bounce-slow"></i>
        <h1 class="text-[clamp(1.2rem,3vw,1.8rem)] font-bold text-primary">快乐英语乐园</h1>
      </div>
      <nav class="hidden md:flex space-x-6">
        <button id="nav-letters" class="nav-btn text-primary font-medium hover:text-accent transition-colors">字母学习</button>
        <button id="nav-matching" class="nav-btn text-gray-600 font-medium hover:text-accent transition-colors">单词匹配</button>
        <button id="nav-quiz" class="nav-btn text-gray-600 font-medium hover:text-accent transition-colors">英语测验</button>
      </nav>
      <button id="mobile-menu-btn" class="md:hidden text-primary text-xl">
        <i class="fa fa-bars"></i>
      </button>
    </div>
    <!-- 移动端菜单 -->
    <div id="mobile-menu" class="hidden md:hidden bg-white shadow-md absolute w-full">
      <div class="container mx-auto px-4 py-2 flex flex-col space-y-3">
        <button id="mobile-letters" class="py-2 text-left text-primary font-medium">字母学习</button>
        <button id="mobile-matching" class="py-2 text-left text-gray-600 font-medium">单词匹配</button>
        <button id="mobile-quiz" class="py-2 text-left text-gray-600 font-medium">英语测验</button>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <main class="container mx-auto px-4 pt-24 pb-16">
    <!-- 欢迎区域 -->
    <section id="welcome-section" class="mb-12 text-center">
      <div class="inline-block bg-white rounded-2xl shadow-lg p-6 md:p-8 max-w-3xl mx-auto transform transition-all duration-500 hover:shadow-xl">
        <h2 class="text-[clamp(1.5rem,4vw,2.5rem)] font-bold text-primary mb-4">欢迎来到英语乐园！</h2>
        <p class="text-gray-700 text-lg mb-6">在这里，我们将一起快乐地学习英语基础知识</p>
        <div class="flex flex-wrap justify-center gap-4">
          <button id="start-letters" class="bg-primary hover:bg-primary/90 text-white font-bold py-3 px-6 rounded-full shadow-md hover:shadow-lg transition-all transform hover:-translate-y-1">
            <i class="fa fa-book mr-2"></i>开始学习字母
          </button>
          <button id="start-matching" class="bg-secondary hover:bg-secondary/90 text-white font-bold py-3 px-6 rounded-full shadow-md hover:shadow-lg transition-all transform hover:-translate-y-1">
            <i class="fa fa-puzzle-piece mr-2"></i>单词匹配游戏
          </button>
        </div>
      </div>
    </section>

    <!-- 字母学习区域 -->
    <section id="letters-section" class="hidden mb-12">
      <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
        <h2 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-primary mb-6 text-center">字母学习</h2>
        
        <div class="mb-8 text-center">
          <p class="text-gray-700 mb-4">点击下面的字母，听听它们的发音！</p>
          <div id="current-letter-display" class="text-[clamp(3rem,10vw,5rem)] font-bold text-accent mb-4">A</div>
          <div id="letter-example" class="text-gray-600">比如：Apple (苹果)</div>
        </div>
        
        <div class="grid grid-cols-5 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-13 gap-3">
          <!-- 字母按钮将通过JS动态生成 -->
        </div>
        
        <div class="mt-8 text-center">
          <button id="letter-sound-btn" class="bg-primary hover:bg-primary/90 text-white font-bold py-2 px-6 rounded-full shadow transition-all">
            <i class="fa fa-volume-up mr-2"></i>听发音
          </button>
        </div>
      </div>
    </section>

    <!-- 单词匹配区域 -->
    <section id="matching-section" class="hidden mb-12">
      <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
        <h2 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-primary mb-6 text-center">单词匹配游戏</h2>
        
        <div class="mb-6 text-center">
          <p class="text-gray-700">找出与图片匹配的单词，锻炼你的记忆力！</p>
          <div id="matching-score" class="mt-2 text-accent font-bold">得分: 0</div>
        </div>
        
        <div id="memory-game" class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6">
          <!-- 记忆卡片将通过JS动态生成 -->
        </div>
        
        <div class="mt-8 text-center">
          <button id="reset-matching" class="bg-secondary hover:bg-secondary/90 text-white font-bold py-2 px-6 rounded-full shadow transition-all">
            <i class="fa fa-refresh mr-2"></i>重新开始
          </button>
        </div>
      </div>
    </section>

    <!-- 英语测验区域 -->
    <section id="quiz-section" class="hidden mb-12">
      <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
        <h2 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-primary mb-6 text-center">英语小测验</h2>
        
        <div class="mb-6">
          <div class="flex justify-between items-center mb-4">
            <p class="text-gray-700">回答下面的问题，测试你的英语水平！</p>
            <div id="quiz-progress" class="text-accent font-bold">问题 1/5</div>
          </div>
          <div id="quiz-score" class="text-right text-primary font-bold">得分: 0</div>
        </div>
        
        <div id="quiz-container" class="mb-8">
          <!-- 测验内容将通过JS动态生成 -->
        </div>
        
        <div class="flex justify-between">
          <button id="prev-question" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-6 rounded-full shadow transition-all disabled:opacity-50 disabled:cursor-not-allowed" disabled>
            <i class="fa fa-arrow-left mr-2"></i>上一题
          </button>
          <button id="next-question" class="bg-primary hover:bg-primary/90 text-white font-bold py-2 px-6 rounded-full shadow transition-all">
            下一题<i class="fa fa-arrow-right ml-2"></i>
          </button>
        </div>
      </div>
    </section>

    <!-- 成就区域 -->
    <section class="mb-12">
      <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
        <h2 class="text-[clamp(1.3rem,3vw,1.8rem)] font-bold text-primary mb-6 text-center">我的成就</h2>
        
        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
          <div class="achievement-card bg-neutral rounded-xl p-4 text-center hover:shadow-md transition-all">
            <div class="w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center mx-auto mb-3">
              <i class="fa fa-book text-primary text-2xl"></i>
            </div>
            <h3 class="font-bold text-gray-800">字母小能手</h3>
            <p class="text-sm text-gray-600 mt-1">学习所有字母</p>
            <div id="letters-achievement" class="mt-2 text-xs text-gray-500">未完成</div>
          </div>
          
          <div class="achievement-card bg-neutral rounded-xl p-4 text-center hover:shadow-md transition-all">
            <div class="w-16 h-16 bg-secondary/20 rounded-full flex items-center justify-center mx-auto mb-3">
              <i class="fa fa-puzzle-piece text-secondary text-2xl"></i>
            </div>
            <h3 class="font-bold text-gray-800">记忆小天才</h3>
            <p class="text-sm text-gray-600 mt-1">完成匹配游戏</p>
            <div id="matching-achievement" class="mt-2 text-xs text-gray-500">未完成</div>
          </div>
          
          <div class="achievement-card bg-neutral rounded-xl p-4 text-center hover:shadow-md transition-all">
            <div class="w-16 h-16 bg-accent/20 rounded-full flex items-center justify-center mx-auto mb-3">
              <i class="fa fa-trophy text-accent text-2xl"></i>
            </div>
            <h3 class="font-bold text-gray-800">测验小冠军</h3>
            <p class="text-sm text-gray-600 mt-1">测验得满分</p>
            <div id="quiz-achievement" class="mt-2 text-xs text-gray-500">未完成</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- 页脚 -->
  <footer class="bg-primary text-white py-6">
    <div class="container mx-auto px-4 text-center">
      <p>快乐英语乐园 &copy; 2023 - 让学习变得更有趣</p>
      <p class="text-sm mt-2 opacity-80">适合二年级学生的英语学习应用</p>
    </div>
  </footer>

  <!-- 成功提示弹窗 -->
  <div id="success-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-2xl p-6 max-w-md w-full text-center transform transition-all scale-95 opacity-0" id="modal-content">
      <div class="text-success text-5xl mb-4">
        <i class="fa fa-check-circle"></i>
      </div>
      <h3 class="text-2xl font-bold text-gray-800 mb-2" id="modal-title">太棒了！</h3>
      <p class="text-gray-600 mb-6" id="modal-message">你完成了这个挑战</p>
      <button id="close-modal" class="bg-primary hover:bg-primary/90 text-white font-bold py-2 px-6 rounded-full shadow transition-all">
        继续学习
      </button>
    </div>
  </div>

  <script>
    // 应用数据
    const appData = {
      // 字母数据
      letters: [
        { letter: 'A', example: 'Apple (苹果)', sound: 'a' },
        { letter: 'B', example: 'Banana (香蕉)', sound: 'b' },
        { letter: 'C', example: 'Cat (猫)', sound: 'c' },
        { letter: 'D', example: 'Dog (狗)', sound: 'd' },
        { letter: 'E', example: 'Elephant (大象)', sound: 'e' },
        { letter: 'F', example: 'Fish (鱼)', sound: 'f' },
        { letter: 'G', example: 'Giraffe (长颈鹿)', sound: 'g' },
        { letter: 'H', example: 'House (房子)', sound: 'h' },
        { letter: 'I', example: 'Ice cream (冰淇淋)', sound: 'i' },
        { letter: 'J', example: 'Juice (果汁)', sound: 'j' },
        { letter: 'K', example: 'Kite (风筝)', sound: 'k' },
        { letter: 'L', example: 'Lion (狮子)', sound: 'l' },
        { letter: 'M', example: 'Monkey (猴子)', sound: 'm' },
        { letter: 'N', example: 'Nose (鼻子)', sound: 'n' },
        { letter: 'O', example: 'Orange (橙子)', sound: 'o' },
        { letter: 'P', example: 'Pencil (铅笔)', sound: 'p' },
        { letter: 'Q', example: 'Queen (女王)', sound: 'q' },
        { letter: 'R', example: 'Rabbit (兔子)', sound: 'r' },
        { letter: 'S', example: 'Sun (太阳)', sound: 's' },
        { letter: 'T', example: 'Tiger (老虎)', sound: 't' },
        { letter: 'U', example: 'Umbrella (雨伞)', sound: 'u' },
        { letter: 'V', example: 'Van (货车)', sound: 'v' },
        { letter: 'W', example: 'Water (水)', sound: 'w' },
        { letter: 'X', example: 'Box (盒子)', sound: 'x' },
        { letter: 'Y', example: 'Yogurt (酸奶)', sound: 'y' },
        { letter: 'Z', example: 'Zoo (动物园)', sound: 'z' }
      ],
      
      // 匹配游戏数据
      matchingWords: [
        { word: 'cat', image: 'https://picsum.photos/id/40/200/200', chinese: '猫' },
        { word: 'dog', image: 'https://picsum.photos/id/237/200/200', chinese: '狗' },
        { word: 'bird', image: 'https://picsum.photos/id/169/200/200', chinese: '鸟' },
        { word: 'fish', image: 'https://picsum.photos/id/1024/200/200', chinese: '鱼' },
        { word: 'apple', image: 'https://picsum.photos/id/1080/200/200', chinese: '苹果' },
        { word: 'banana', image: 'https://picsum.photos/id/1065/200/200', chinese: '香蕉' },
        { word: 'car', image: 'https://picsum.photos/id/1072/200/200', chinese: '汽车' },
        { word: 'ball', image: 'https://picsum.photos/id/1068/200/200', chinese: '球' }
      ],
      
      // 测验数据
      quizQuestions: [
        {
          question: "哪个单词是'猫'的意思？",
          options: ["dog", "cat", "bird"],
          correct: 1,
          image: "https://picsum.photos/id/40/150/150"
        },
        {
          question: "图片中的水果是什么？",
          options: ["banana", "apple", "orange"],
          correct: 0,
          image: "https://picsum.photos/id/1065/150/150"
        },
        {
          question: "'A'开头的单词是？",
          options: ["ball", "apple", "cat"],
          correct: 1,
          image: null
        },
        {
          question: "这个动物是什么？",
          options: ["tiger", "dog", "fish"],
          correct: 0,
          image: "https://picsum.photos/id/239/150/150"
        },
        {
          question: "哪个单词表示一种交通工具？",
          options: ["car", "book", "tree"],
          correct: 0,
          image: null
        }
      ]
    };

    // 应用状态
    const appState = {
      currentLetter: 'A',
      currentLetterIndex: 0,
      matchingScore: 0,
      flippedCards: [],
      matchedPairs: 0,
      currentQuestion: 0,
      quizScore: 0,
      selectedAnswer: null,
      completedActivities: {
        letters: false,
        matching: false,
        quiz: false
      }
    };

    // DOM元素
    const elements = {
      // 导航元素
      navLetters: document.getElementById('nav-letters'),
      navMatching: document.getElementById('nav-matching'),
      navQuiz: document.getElementById('nav-quiz'),
      mobileMenuBtn: document.getElementById('mobile-menu-btn'),
      mobileMenu: document.getElementById('mobile-menu'),
      mobileLetters: document.getElementById('mobile-letters'),
      mobileMatching: document.getElementById('mobile-matching'),
      mobileQuiz: document.getElementById('mobile-quiz'),
      
      // 区域元素
      welcomeSection: document.getElementById('welcome-section'),
      lettersSection: document.getElementById('letters-section'),
      matchingSection: document.getElementById('matching-section'),
      quizSection: document.getElementById('quiz-section'),
      
      // 字母学习元素
      startLetters: document.getElementById('start-letters'),
      currentLetterDisplay: document.getElementById('current-letter-display'),
      letterExample: document.getElementById('letter-example'),
      letterSoundBtn: document.getElementById('letter-sound-btn'),
      lettersGrid: document.querySelector('#letters-section .grid'),
      
      // 匹配游戏元素
      startMatching: document.getElementById('start-matching'),
      memoryGame: document.getElementById('memory-game'),
      matchingScore: document.getElementById('matching-score'),
      resetMatching: document.getElementById('reset-matching'),
      
      // 测验元素
      quizContainer: document.getElementById('quiz-container'),
      quizProgress: document.getElementById('quiz-progress'),
      quizScore: document.getElementById('quiz-score'),
      prevQuestion: document.getElementById('prev-question'),
      nextQuestion: document.getElementById('next-question'),
      
      // 成就元素
      lettersAchievement: document.getElementById('letters-achievement'),
      matchingAchievement: document.getElementById('matching-achievement'),
      quizAchievement: document.getElementById('quiz-achievement'),
      
      // 弹窗元素
      successModal: document.getElementById('success-modal'),
      modalContent: document.getElementById('modal-content'),
      modalTitle: document.getElementById('modal-title'),
      modalMessage: document.getElementById('modal-message'),
      closeModal: document.getElementById('close-modal')
    };

    // 初始化应用
    function initApp() {
      // 初始化字母学习区域
      initLettersSection();
      
      // 初始化匹配游戏
      initMatchingGame();
      
      // 初始化测验
      initQuiz();
      
      // 设置事件监听器
      setupEventListeners();
    }

    // 初始化字母学习区域
    function initLettersSection() {
      // 生成字母按钮
      appData.letters.forEach((letterData, index) => {
        const letterBtn = document.createElement('button');
        letterBtn.className = `letter-btn bg-primary/10 hover:bg-primary/20 text-primary font-bold text-xl rounded-lg p-3 transition-all ${index === 0 ? 'bg-primary text-white' : ''}`;
        letterBtn.textContent = letterData.letter;
        letterBtn.dataset.index = index;
        
        letterBtn.addEventListener('click', () => {
          selectLetter(index);
        });
        
        elements.lettersGrid.appendChild(letterBtn);
      });
      
      // 设置字母发音按钮事件
      elements.letterSoundBtn.addEventListener('click', playLetterSound);
    }

    // 选择字母
    function selectLetter(index) {
      // 更新状态
      appState.currentLetterIndex = index;
      const letterData = appData.letters[index];
      appState.currentLetter = letterData.letter;
      
      // 更新UI
      elements.currentLetterDisplay.textContent = letterData.letter;
      elements.letterExample.textContent = `比如：${letterData.example}`;
      
      // 更新按钮样式
      document.querySelectorAll('.letter-btn').forEach((btn, i) => {
        if (i === index) {
          btn.classList.remove('bg-primary/10', 'hover:bg-primary/20', 'text-primary');
          btn.classList.add('bg-primary', 'text-white');
        } else {
          btn.classList.remove('bg-primary', 'text-white');
          btn.classList.add('bg-primary/10', 'hover:bg-primary/20', 'text-primary');
        }
      });
      
      // 播放字母发音
      playLetterSound();
      
      // 检查是否所有字母都被点击过
      checkLettersAchievement();
    }

    // 播放字母发音
    function playLetterSound() {
      const letterData = appData.letters[appState.currentLetterIndex];
      // 使用Web Speech API发音
      const utterance = new SpeechSynthesisUtterance(letterData.letter);
      utterance.lang = 'en-US';
      speechSynthesis.speak(utterance);
    }

    // 检查字母学习成就
    function checkLettersAchievement() {
      const allLettersClicked = Array.from(document.querySelectorAll('.letter-btn')).every(btn => 
        btn.classList.contains('bg-primary') || btn.classList.contains('bg-primary/10')
      );
      
      if (allLettersClicked && !appState.completedActivities.letters) {
        appState.completedActivities.letters = true;
        elements.lettersAchievement.textContent = '已完成';
        elements.lettersAchievement.classList.add('text-success', 'font-bold');
        
        showSuccessModal('字母小能手', '你已经学习了所有字母！真棒！');
      }
    }

    // 初始化匹配游戏
    function initMatchingGame() {
      resetMatchingGame();
    }

    // 重置匹配游戏
    function resetMatchingGame() {
      // 重置状态
      appState.matchingScore = 0;
      appState.flippedCards = [];
      appState.matchedPairs = 0;
      
      // 更新分数显示
      elements.matchingScore.textContent = `得分: ${appState.matchingScore}`;
      
      // 清空游戏区域
      elements.memoryGame.innerHTML = '';
      
      // 创建卡片数据（每个项目有两个卡片：图片和单词）
      let cards = [];
      
      appData.matchingWords.forEach(item => {
        // 图片卡片
        cards.push({
          type: 'image',
          content: item.image,
          pairId: item.word
        });
        
        // 单词卡片
        cards.push({
          type: 'word',
          content: item.word,
          pairId: item.word,
          chinese: item.chinese
        });
      });
      
      // 打乱卡片顺序
      cards = shuffleArray(cards);
      
      // 创建卡片元素
      cards.forEach((card, index) => {
        const cardElement = createMemoryCard(card, index);
        elements.memoryGame.appendChild(cardElement);
      });
    }

    // 创建记忆卡片
    function createMemoryCard(cardData, index) {
      const card = document.createElement('div');
      card.className = 'card-flip h-36 md:h-48 cursor-pointer';
      card.dataset.index = index;
      card.dataset.pairId = cardData.pairId;
      card.dataset.type = cardData.type;
      
      let frontContent = '';
      let backContent = '';
      
      // 卡片正面（统一设计）
      frontContent = `
        <div class="absolute inset-0 bg-primary rounded-xl flex items-center justify-center text-white text-2xl shadow-md">
          <i class="fa fa-question-circle"></i>
        </div>
      `;
      
      // 卡片背面（根据类型显示不同内容）
      if (cardData.type === 'image') {
        backContent = `
          <div class="absolute inset-0 bg-white rounded-xl shadow-md overflow-hidden">
            <img src="${cardData.content}" alt="图片" class="w-full h-full object-cover">
          </div>
        `;
      } else {
        backContent = `
          <div class="absolute inset-0 bg-secondary/10 rounded-xl flex flex-col items-center justify-center p-2">
            <div class="text-lg md:text-xl font-bold text-secondary">${cardData.content}</div>
            <div class="text-xs text-gray-600 mt-1">${cardData.chinese}</div>
          </div>
        `;
      }
      
      card.innerHTML = `
        <div class="card-inner relative w-full h-full">
          <div class="card-front absolute inset-0">${frontContent}</div>
          <div class="card-back absolute inset-0">${backContent}</div>
        </div>
      `;
      
      // 添加点击事件
      card.addEventListener('click', () => flipCard(card));
      
      return card;
    }

    // 翻转卡片
    function flipCard(card) {
      // 如果卡片已经翻开或匹配成功，不执行操作
      if (card.classList.contains('card-flipped') || card.classList.contains('matched')) {
        return;
      }
      
      // 如果已经翻开两张卡片，不执行操作
      if (appState.flippedCards.length >= 2) {
        return;
      }
      
      // 翻转卡片
      card.classList.add('card-flipped');
      
      // 添加到已翻开卡片列表
      appState.flippedCards.push(card);
      
      // 如果翻开了两张卡片，检查是否匹配
      if (appState.flippedCards.length === 2) {
        setTimeout(checkForMatch, 500);
      }
    }

    // 检查卡片是否匹配
    function checkForMatch() {
      const [card1, card2] = appState.flippedCards;
      
      // 检查是否匹配（pairId相同且类型不同）
      if (card1.dataset.pairId === card2.dataset.pairId && 
          card1.dataset.type !== card2.dataset.type) {
        // 匹配成功
        card1.classList.add('matched', 'bg-success/20');
        card2.classList.add('matched', 'bg-success/20');
        
        // 增加分数
        appState.matchingScore += 10;
        elements.matchingScore.textContent = `得分: ${appState.matchingScore}`;
        
        // 增加匹配对数
        appState.matchedPairs++;
        
        // 检查是否完成所有匹配
        if (appState.matchedPairs === appData.matchingWords.length) {
          setTimeout(() => {
            appState.completedActivities.matching = true;
            elements.matchingAchievement.textContent = '已完成';
            elements.matchingAchievement.classList.add('text-success', 'font-bold');
            
            showSuccessModal('记忆小天才', '你完成了所有匹配！太厉害了！');
          }, 500);
        }
      } else {
        // 匹配失败，翻回卡片
        setTimeout(() => {
          card1.classList.remove('card-flipped');
          card2.classList.remove('card-flipped');
        }, 800);
      }
      
      // 清空已翻开卡片列表
      appState.flippedCards = [];
    }

    // 初始化测验
    function initQuiz() {
      showCurrentQuestion();
    }

    // 显示当前问题
    function showCurrentQuestion() {
      const question = appData.quizQuestions[appState.currentQuestion];
      
      // 更新进度
      elements.quizProgress.textContent = `问题 ${appState.currentQuestion + 1}/${appData.quizQuestions.length}`;
      
      // 清空容器
      elements.quizContainer.innerHTML = '';
      
      // 创建问题元素
      const questionElement = document.createElement('div');
      
      let questionHTML = `
        <div class="mb-6">
          <h3 class="text-xl font-bold text-gray-800 mb-4">${question.question}</h3>
      `;
      
      // 如果有图片，添加图片
      if (question.image) {
        questionHTML += `
          <div class="mb-4 flex justify-center">
            <img src="${question.image}" alt="问题图片" class="rounded-lg shadow-md max-w-full h-40 object-cover">
          </div>
        `;
      }
      
      questionHTML += `</div><div class="space-y-3">`;
      
      // 添加选项
      question.options.forEach((option, index) => {
        questionHTML += `
          <div class="option-item">
            <label class="flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-neutral transition-colors ${appState.selectedAnswer === index ? 'bg-primary/10 border-primary' : ''}">
              <input type="radio" name="quiz-option" value="${index}" class="mr-3 h-5 w-5 text-primary" ${appState.selectedAnswer === index ? 'checked' : ''}>
              <span class="text-gray-800">${option}</span>
            </label>
          </div>
        `;
      });
      
      questionHTML += `</div>`;
      
      questionElement.innerHTML = questionHTML;
      elements.quizContainer.appendChild(questionElement);
      
      // 添加选项点击事件
      document.querySelectorAll('.option-item input').forEach(radio => {
        radio.addEventListener('change', (e) => {
          appState.selectedAnswer = parseInt(e.target.value);
          // 更新UI显示选中状态
          document.querySelectorAll('.option-item label').forEach((label, index) => {
            if (index === appState.selectedAnswer) {
              label.classList.add('bg-primary/10', 'border-primary');
            } else {
              label.classList.remove('bg-primary/10', 'border-primary');
            }
          });
        });
      });
      
      // 更新按钮状态
      updateQuizButtons();
    }

    // 更新测验按钮状态
    function updateQuizButtons() {
      // 上一题按钮
      elements.prevQuestion.disabled = appState.currentQuestion === 0;
      
      // 下一题按钮文本
      if (appState.currentQuestion === appData.quizQuestions.length - 1) {
        elements.nextQuestion.innerHTML = '完成测验<i class="fa fa-check ml-2"></i>';
      } else {
        elements.nextQuestion.innerHTML = '下一题<i class="fa fa-arrow-right ml-2"></i>';
      }
    }

    // 前往下一题
    function goToNextQuestion() {
      // 如果没有选择答案，提示用户
      if (appState.selectedAnswer === null) {
        alert('请选择一个答案');
        return;
      }
      
      // 检查是否答对
      const question = appData.quizQuestions[appState.currentQuestion];
      if (appState.selectedAnswer === question.correct) {
        appState.quizScore += 20;
        elements.quizScore.textContent = `得分: ${appState.quizScore}`;
      }
      
      // 如果是最后一题，完成测验
      if (appState.currentQuestion === appData.quizQuestions.length - 1) {
        completeQuiz();
        return;
      }
      
      // 前往下一题
      appState.currentQuestion++;
      appState.selectedAnswer = null;
      showCurrentQuestion();
    }

    // 前往上一题
    function goToPrevQuestion() {
      if (appState.currentQuestion > 0) {
        appState.currentQuestion--;
        // 保存之前的答案
        const question = appData.quizQuestions[appState.currentQuestion];
        appState.selectedAnswer = null; // 可以改为保存用户之前的答案
        showCurrentQuestion();
      }
    }

    // 完成测验
    function completeQuiz() {
      // 检查是否满分
      const isPerfectScore = appState.quizScore === appData.quizQuestions.length * 20;
      
      if (isPerfectScore && !appState.completedActivities.quiz) {
        appState.completedActivities.quiz = true;
        elements.quizAchievement.textContent = '已完成';
        elements.quizAchievement.classList.add('text-success', 'font-bold');
      }
      
      // 显示结果
      showSuccessModal(
        isPerfectScore ? '测验小冠军！' : '完成测验',
        `你的得分是 ${appState.quizScore} 分！${isPerfectScore ? '太厉害了，满分！' : '继续努力哦！'}`
      );
      
      // 重置测验
      setTimeout(() => {
        appState.currentQuestion = 0;
        appState.quizScore = 0;
        appState.selectedAnswer = null;
        elements.quizScore.textContent = `得分: 0`;
        showCurrentQuestion();
      }, 2000);
    }

    // 显示成功弹窗
    function showSuccessModal(title, message) {
      elements.modalTitle.textContent = title;
      elements.modalMessage.textContent = message;
      
      elements.successModal.classList.remove('hidden');
      // 触发动画
      setTimeout(() => {
        elements.modalContent.classList.remove('scale-95', 'opacity-0');
        elements.modalContent.classList.add('scale-100', 'opacity-100');
      }, 10);
    }

    // 隐藏成功弹窗
    function hideSuccessModal() {
      elements.modalContent.classList.remove('scale-100', 'opacity-100');
      elements.modalContent.classList.add('scale-95', 'opacity-0');
      
      setTimeout(() => {
        elements.successModal.classList.add('hidden');
      }, 300);
    }

    // 切换到指定区域
    function switchToSection(sectionId) {
      // 隐藏所有区域
      elements.welcomeSection.classList.add('hidden');
      elements.lettersSection.classList.add('hidden');
      elements.matchingSection.classList.add('hidden');
      elements.quizSection.classList.add('hidden');
      
      // 重置导航按钮样式
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.remove('text-primary');
        btn.classList.add('text-gray-600');
      });
      
      // 显示选中的区域
      switch(sectionId) {
        case 'letters':
          elements.lettersSection.classList.remove('hidden');
          elements.navLetters.classList.remove('text-gray-600');
          elements.navLetters.classList.add('text-primary');
          elements.mobileLetters.classList.remove('text-gray-600');
          elements.mobileLetters.classList.add('text-primary');
          break;
        case 'matching':
          elements.matchingSection.classList.remove('hidden');
          elements.navMatching.classList.remove('text-gray-600');
          elements.navMatching.classList.add('text-primary');
          elements.mobileMatching.classList.remove('text-gray-600');
          elements.mobileMatching.classList.add('text-primary');
          break;
        case 'quiz':
          elements.quizSection.classList.remove('hidden');
          elements.navQuiz.classList.remove('text-gray-600');
          elements.navQuiz.classList.add('text-primary');
          elements.mobileQuiz.classList.remove('text-gray-600');
          elements.mobileQuiz.classList.add('text-primary');
          break;
        default:
          elements.welcomeSection.classList.remove('hidden');
      }
      
      // 关闭移动菜单
      elements.mobileMenu.classList.add('hidden');
      
      // 滚动到顶部
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // 打乱数组顺序（ Fisher-Yates 洗牌算法）
    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }

    // 设置事件监听器
    function setupEventListeners() {
      // 导航事件
      elements.navLetters.addEventListener('click', () => switchToSection('letters'));
      elements.navMatching.addEventListener('click', () => switchToSection('matching'));
      elements.navQuiz.addEventListener('click', () => switchToSection('quiz'));
      
      // 移动端菜单事件
      elements.mobileMenuBtn.addEventListener('click', () => {
        elements.mobileMenu.classList.toggle('hidden');
      });
      
      elements.mobileLetters.addEventListener('click', () => switchToSection('letters'));
      elements.mobileMatching.addEventListener('click', () => switchToSection('matching'));
      elements.mobileQuiz.addEventListener('click', () => switchToSection('quiz'));
      
      // 开始按钮事件
      elements.startLetters.addEventListener('click', () => switchToSection('letters'));
      elements.startMatching.addEventListener('click', () => switchToSection('matching'));
      
      // 匹配游戏重置按钮
      elements.resetMatching.addEventListener('click', resetMatchingGame);
      
      // 测验按钮事件
      elements.prevQuestion.addEventListener('click', goToPrevQuestion);
      elements.nextQuestion.addEventListener('click', goToNextQuestion);
      
      // 弹窗关闭按钮
      elements.closeModal.addEventListener('click', hideSuccessModal);
      
      // 点击弹窗背景关闭弹窗
      elements.successModal.addEventListener('click', (e) => {
        if (e.target === elements.successModal) {
          hideSuccessModal();
        }
      });
      
      // 滚动时改变导航栏样式
      window.addEventListener('scroll', () => {
        const header = document.querySelector('header');
        if (window.scrollY > 50) {
          header.classList.add('py-2', 'shadow');
          header.classList.remove('py-3');
        } else {
          header.classList.add('py-3');
          header.classList.remove('py-2', 'shadow');
        }
      });
    }

    // 启动应用
    document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>
